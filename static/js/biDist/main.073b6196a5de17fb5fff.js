!function(e){function t(t){for(var r,i,c=t[0],u=t[1],l=t[2],f=0,p=[];f<c.length;f++)i=c[f],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(s&&s(t);p.length;)p.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,c=1;c<n.length;c++){var u=n[c];0!==a[u]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={1:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=a[e]=[t,r]}));t.push(n[2]=r);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,i.nc&&c.setAttribute("nonce",i.nc),c.src=function(e){return i.p+""+({}[e]||e)+".073b6196a5de17fb5fff.js"}(e);var u=new Error;o=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",u.name="ChunkLoadError",u.type=r,u.request=o,n[1](u)}a[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(t)},i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var c=window.webpackJsonp=window.webpackJsonp||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var s=u;o.push([327,0,2]),n()}({0:function(e,t,n){e.exports=n(108)(0)},103:function(e,t,n){e.exports={container:"_3na_5ug6uN_WskzAnvuHvR"}},105:function(e,t,n){e.exports={axis:"_1DbbL8lpN9wQzeWQ_kG5i7",type:"_1ByzGbxbDGZ3dhHD1LjzlU",fields:"bxHYq9wuoEhDYPrWGNaat"}},108:function(e,t){e.exports=react_f75c8661f5d94fd65ee1},130:function(e,t,n){e.exports={steps:"Q9XW_v-R7zzyrni18_Gc-"}},131:function(e,t,n){e.exports={field:"_2hnvtxEasuSFdnK5CO4WAO",dimension:"_1ovk0LKmhzHYiNCzPeILXJ",measure:"ct4LwJcciodU6x-a0YVc_"}},153:function(e,t,n){},157:function(e,t,n){e.exports={menus:"_2jwCWPsMYz6bTqytLLUt_K"}},160:function(e,t,n){},173:function(e,t,n){},181:function(e,t,n){e.exports={attr:"_3CsVSv0RCiJOOS1_15miYJ"}},196:function(e,t,n){e.exports=n(108)(1)},326:function(e,t,n){},327:function(e,t,n){"use strict";n.r(t);var r,a=n(0),o=n.n(a),i=n(4),c=n.n(i),u=(n(59),n(13)),l=(n(60),n(21)),s=n(103),f=n.n(s),p=(n(109),n(32)),d=n(34),m=n(153),h=n.n(m),y=n(39),v=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),b=p.a.Item,g=p.a.SubMenu,w=(p.a.ItemGroup,Object(y.b)((function(e){var t;return(null===(t=e.nav)||void 0===t?void 0:t.top)||{}}))(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){(0,t.props.dispatch)({type:"SET_TOP_NAV",payload:{current:e.key}})},t}return v(t,e),t.prototype.render=function(){var e=this.props,t=e.menus,n=void 0===t?[]:t,r=e.current;return o.a.createElement("div",{className:h.a.top},o.a.createElement(p.a,{onClick:this.handleClick,selectedKeys:[r],mode:"horizontal"},o.a.createElement(b,{key:"home"},o.a.createElement("div",{style:{width:"213px",textAlign:"center"}},o.a.createElement("a",{href:"/mugong/bi"},"首页导航"))),n.map((function(e){if(e.children&&e.children.length){var t=e.title,n=e.children;return o.a.createElement(g,{title:t},n.map((function(e){return o.a.createElement(b,{key:e.key},e.title)})))}return o.a.createElement(b,{key:e.key},o.a.createElement(d.b,{to:"/mugong/bi/pages"},e.title))}))))},t}(o.a.Component))),E=(n(76),n(26)),_=n(157),x=n.n(_),S={current:"",menus:[{key:"pages",title:"页面列表"}]},O={map:{}};function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var N=function(){return(N=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},C=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},j=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},T="my_db_1.0",P="my_table_field",A="my_nav_setting",R="my_pages",I=function(){function e(e,t){if(!e)throw E.a.error("创建database时，名称必填"),"database name should be not null";this.name=e,this.options=N({version:"1.0"},t);var n=this.options,r=n.version,a=n.desc,o=n.size,i=n.callback;this.db=window.openDatabase(e,r,a,o,i)}return e.create=function(t,n){return new e(t,n)},e.prototype.transaction=function(e,t){var n=(t||{}).readOnly;this.db[n?"readTransaction":"transaction"](e)},e.prototype.createTable=function(e,t){var n=this;return new Promise((function(r,a){n.db.transaction((function(n){n.executeSql("CREATE TABLE IF NOT EXISTS "+e+" ("+t.join(",")+")",[],(function(){return r(!0)}),(function(){return a(new Error("create table got errors"))}))}))}))},e.prototype.query=function(e){var t=this;return new Promise((function(n,r){t.db.readTransaction((function(t){t.executeSql(e,[],(function(e,t){n([].slice.call(t.rows||[]))}),(function(){return r(new Error("the query got error"))}))}))}))},e.prototype.insert=function(e,t){var n=this;return t=(t=Array.isArray(t[0])?t:[t]).map((function(e){return"("+e.map((function(e){return"string"==typeof e&&(e='"'+e+'"'),e})).join(",")+")"})),new Promise((function(r,a){n.db.transaction((function(n){n.executeSql("insert into "+e+" values "+t.join(","),[],(function(){return r(!0)}),(function(){return a(new Error("insert to table find errors"))}))}))}))},e.prototype.update=function(e,t,n){var r=this;void 0===n&&(n="1=1");var a=Object.keys(t).map((function(e){return e+" = "+JSON.stringify(t[e])})).join(",");return"object"===k(n)&&(n=Object.keys(n).map((function(e){return e+" = "+JSON.stringify(n[e])})).join(" and ")),new Promise((function(t,o){r.db.transaction((function(r){r.executeSql("update "+e+" set "+a+" where "+n,[],(function(){return t(!0)}),(function(){return o(new Error("update find errors"))}))}))}))},e.prototype.del=function(e,t){var n=this;return"object"===k(t)&&(t=Object.keys(t).map((function(e){return e+" = "+JSON.stringify(t[e])})).join(" and ")),new Promise((function(r,a){n.db.transaction((function(n){n.executeSql("delete from "+e+" where "+t,[],(function(){return r(!0)}),(function(){return a(new Error("update find errors"))}))}))}))},e.prototype.drop=function(e){var t=this;return new Promise((function(n,r){t.db.transaction((function(t){t.executeSql("drop table "+e,[],(function(){n(!0)}),(function(){r(new Error("failed drop the table"))}))}))}))},e.prototype.clear=function(){var e=this;return new Promise((function(t,n){e.db.transaction((function(e){e.executeSql("drop database "+T,[],(function(){localStorage.setItem("nav_has_setted",""),t(!0)}),(function(){n(new Error("failed drop the database"))}))}))}))},e}(),L=window.database=I.create(T);C(void 0,void 0,void 0,(function(){return j(this,(function(e){try{localStorage.getItem("nav_has_setted")||(localStorage.setItem("nav_has_setted","true"),L.createTable(P,["tb_name","field","type"]),L.createTable(A,["top","left"]),L.insert(A,[encodeURIComponent(JSON.stringify(S)),encodeURIComponent(JSON.stringify(O))]))}catch(e){console.error("error",e)}return[2]}))}));var J=n(332),q=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),D=function(){return(D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},U=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},z=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},M=p.a.Item,G=p.a.SubMenu,W=/\/(\d+)\/?$/,K=Object(y.b)((function(e){var t,n,r;return D(D({},null===(t=e.nav)||void 0===t?void 0:t.left),{type:null===(r=null===(n=e.nav)||void 0===n?void 0:n.top)||void 0===r?void 0:r.current})}))(function(e){function t(t){var n=e.call(this,t)||this;n.onDelMenu=function(e){return U(n,void 0,void 0,(function(){var t,n,r,a,o;return z(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=this.state.defaultSelectedKeys[0],[4,L.query("select left from "+A)];case 1:return n=i.sent(),r=null===(o=n[0])||void 0===o?void 0:o.left,r=JSON.parse(decodeURIComponent(r)),r=D(D({},r),{map:D(D({},r.map),{pages:r.map.pages.filter((function(t){return t.key!==e}))})}),[4,L.update(A,{left:encodeURIComponent(JSON.stringify(r))})];case 2:return i.sent(),[4,L.del(R,{id:t})];case 3:return i.sent(),location.href="/pages",[3,5];case 4:return a=i.sent(),E.a.error(a.message),[3,5];case 5:return[2]}}))}))};var r=location.pathname.match(W);return n.state={defaultSelectedKeys:r?[r[1]]:[]},n}return q(t,e),t.prototype.renderMenuItem=function(e){var t=this,n=this.props.type,r=void 0===n?"":n;return e.map((function(e){var n=e.key,a=e.title;return e.children&&e.children.length?o.a.createElement(G,{key:n,title:a},t.renderMenuItem(e.children)):o.a.createElement(M,{key:n},o.a.createElement(l.a,null,o.a.createElement(u.a,{flex:1},o.a.createElement(d.b,{to:"/mugong/bi/"+r+"/"+n},a)),o.a.createElement(u.a,{flex:"18px"},o.a.createElement("a",{onClick:function(){return t.onDelMenu(n)}},o.a.createElement(J.a,null)))))}))},t.prototype.render=function(){var e=this.props,t=e.type,n=void 0===t?"default":t,r=e.map,a=(void 0===r?{}:r)[n]||[],i=this.state.defaultSelectedKeys;return o.a.createElement("div",{className:x.a.menus},o.a.createElement(p.a,{defaultSelectedKeys:i,mode:"inline",theme:"light"},this.renderMenuItem(a)))},t}(o.a.Component)),F=(n(77),n(18)),V=(n(230),n(133)),H=n(130),Q=n.n(H),X=n(160),Z=n.n(X),Y=(n(329),n(183)),B=n(333),$=n(161),ee=n.n($),te=function(){function e(){}return e.prototype.parse=function(e){return new Promise((function(t,n){var r=new FileReader;r.onloadend=function(e){var a=r.result,o=new ee.a.Workbook;window.workbook=o,o.xlsx.load(a).then((function(e){var t=[];return e.worksheets.forEach((function(e,n){t[n]={table:e.name,rows:[]};var r=t[n].rows;e.eachRow((function(e){r.push(e.values.slice(1))}))})),t})).then((function(e){t(e)})).catch((function(e){n(e)}))},r.readAsArrayBuffer(e)}))},e}();var ne=function(e){return Object.prototype.toString.call(e).slice(8,-1)},re=function(e){void 0===e&&(e="");try{return e=decodeURIComponent(e),JSON.parse(e)}catch(e){return}},ae=function(){return(ae=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},oe=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},ie=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},ce=Y.a.Dragger,ue={name:"file",accept:".xls,.xlsx",showUploadList:!1,customRequest:function(){E.a.info("数据已创建成功，请新建页面，制作报表")},beforeUpload:function(e){var t=this;return(new te).parse(e).then((function(e){return Promise.all(e.map((function(e){return new Promise((function(n,r){return oe(t,void 0,void 0,(function(){var t,a,o,i;return ie(this,(function(c){switch(c.label){case 0:t=e.table,a=e.rows,o=(o=a[0]).map((function(e){return"string"==typeof e&&(e=e.replace(/[-^/|]/g,"_")),e})),c.label=1;case 1:return c.trys.push([1,5,,6]),[4,L.insert(P,(a[1]||[]).map((function(e,n){return[t,o[n],ne(e).toLowerCase()]})))];case 2:return c.sent(),[4,L.createTable(t,o)];case 3:return c.sent(),[4,L.insert(t,a.slice(1).map((function(e){return e.map((function(e){return"string"==typeof e&&(e=e.replace(/[-^/|]/g,"_")),"Date"===ne(e)&&(e=e.toISOString().replace(/T|(\.\d{3}Z)/g," ")),e}))})))];case 4:return c.sent(),n(!0),[3,6];case 5:return i=c.sent(),r(i),[3,6];case 6:return[2]}}))}))}))})))}))},onChange:function(e){var t=e.file.status;"uploading"!==t&&console.log(e.file,e.fileList),"done"===t?E.a.success(e.file.name+" file uploaded successfully."):"error"===t&&E.a.error(e.file.name+" file upload failed.")}},le=function(){return o.a.createElement(ce,ae({},ue),o.a.createElement("p",{className:"ant-upload-drag-icon"},o.a.createElement(B.a,null)),o.a.createElement("p",{className:"ant-upload-text"},"拖拽或点击加载需要使用的excel数据源"),o.a.createElement("p",{className:"ant-upload-hint"},"目前只支持excel文件上传，可以多sheets。完全本地化，数据源不会同步远端"))},se=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fe=function(e){function t(t){var n=e.call(this,t)||this;return n.state={count:1,config:{}},n.onClick=function(){n.setState({count:n.state.count+1})},n}return se(t,e),t.prototype.render=function(){return o.a.createElement("div",{className:Z.a.wrapper},o.a.createElement(le,null))},t}(o.a.Component),pe=(n(149),n(100)),de=(n(282),n(184)),me=n(14),he=function(){return(he=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ye=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},ve=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},be=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,c=o.length;i<c;i++,a++)r[a]=o[i];return r},ge=function(e){var t=e.onClose,n=Object(me.e)(),r=Object(a.useState)(""),i=r[0],c=r[1];return o.a.createElement(de.a,{title:"新建页面",visible:!0,onOk:function(){return ye(void 0,void 0,void 0,(function(){var e,t,r,a,o;return ve(this,(function(c){switch(c.label){case 0:if(!i.trim())return[3,7];"pages",e=Math.random().toString().slice(2),c.label=1;case 1:return c.trys.push([1,6,,7]),[4,L.createTable(R,["id","name","components"])];case 2:return c.sent(),[4,L.insert(R,[e,i,encodeURIComponent(JSON.stringify([]))])];case 3:return c.sent(),[4,L.query("select left from "+A)];case 4:return t=c.sent(),r=null===(o=t[0])||void 0===o?void 0:o.left,r=JSON.parse(decodeURIComponent(r)),r=he(he({},r),{map:he(he({},r.map),{pages:be(r.map.pages||[],[{key:e,title:i}])})}),[4,L.update(A,{left:encodeURIComponent(JSON.stringify(r))})];case 5:return c.sent(),n.push("/mugong/bi/pages/"+e),[3,7];case 6:return a=c.sent(),E.a.error(a.message),[3,7];case 7:return[2]}}))}))},onCancel:t},o.a.createElement("span",null,"页面名称："),o.a.createElement(pe.a,{value:i,onChange:function(e){return c(e.target.value)},placeholder:"请输入页面名称"}))},we=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ee=V.a.Step,_e=function(e){function t(t){var n=e.call(this,t)||this;return n.state={visible:!1,config:{}},n.onTogglePage=function(){n.setState({visible:!n.state.visible})},n}return we(t,e),t.prototype.render=function(){var e=this.state,t=(e.config,e.visible);return o.a.createElement("div",{className:Q.a.wrapper},o.a.createElement(V.a,{className:Q.a.steps,progressDot:!0,current:3,size:"default",direction:"vertical"},o.a.createElement(Ee,{title:"上传excel数据",description:o.a.createElement(fe,null)}),o.a.createElement(Ee,{title:"新建页面",description:o.a.createElement(F.a,{onClick:this.onTogglePage},"\b新建")}),o.a.createElement(Ee,{title:"为页面添加图表",description:o.a.createElement(d.b,{to:"/mugong/bi/add"},"去添加图表")})),t&&o.a.createElement(ge,{onClose:this.onTogglePage}))},t}(o.a.Component),xe=(n(304),n(132)),Se=n(173),Oe=n.n(Se),ke=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ne=function(){return(Ne=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ce=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},je=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Te=function(e){function t(t){var n=e.call(this,t)||this;return n.state={nav:{},topSelected:"",leftSelected:""},n.onRightClickTop=function(e){e.node.key},n.selectTopMenu=function(e,t){n.setState({topSelected:e[0]})},n.selectLeftMenu=function(e,t){n.setState({leftSelected:e[0]})},n.fetch(),n}return ke(t,e),t.prototype.fetch=function(){return Ce(this,void 0,void 0,(function(){var e,t,n,r;return je(this,(function(a){switch(a.label){case 0:return[4,L.query("SELECT top, left FROM "+A+" limit 1")];case 1:return e=a.sent(),t=e&&e[0]||{},n=t.top,r=t.left,this.setState({nav:{top:re(n),left:re(r)}}),[2]}}))}))},t.prototype.render=function(){var e=this.state.nav,t=e.left,n=void 0===t?{}:t,r=e.top,a=void 0===r?{}:r,i=this.state.topSelected,c=a.menus,s=void 0===c?[]:c,f=n.map,p=(void 0===f?{}:f)[i]||[];return o.a.createElement("div",{className:Oe.a.wrapper},o.a.createElement(l.a,null,o.a.createElement(u.a,null,o.a.createElement(xe.a,{onRightClick:this.onRightClickTop,onSelect:this.selectTopMenu,treeData:[{title:"顶部导航栏",key:"0",children:s.map((function(e){return Ne({key:"random"},e)}))}]})),o.a.createElement(u.a,{offset:2},o.a.createElement(xe.a,{onSelect:this.selectLeftMenu,treeData:[{title:"左侧导航栏",key:"0",children:p.map((function(e){return Ne({key:"random"},e)}))}]}))))},t}(o.a.Component),Pe=n(63),Ae=n(42),Re=n.n(Ae),Ie=n(99),Le=n(334),Je=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qe=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},De=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Ue=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,c=o.length;i<c;i++,a++)r[a]=o[i];return r},ze=o.a.forwardRef((function(e,t){return o.a.createElement("div",{ref:t,className:Re.a.row},e.children)})),Me=function(e){function t(t){var n=e.call(this,t)||this;return n.state={list:[]},n.setList=function(e){n.setState({list:e})},n.onDelComponent=function(e){return qe(n,void 0,void 0,(function(){var t,n,r,a;return De(this,(function(o){switch(o.label){case 0:return t=this.props.match,n=(t.params||{}).id,[4,L.query("select components from "+R+" where id="+JSON.stringify(n))];case 1:return r=o.sent(),a=r[0]&&r[0].components||"",a=(a=JSON.parse(decodeURIComponent(a))||[]).filter((function(t){return t.id!==e})),this.setState({list:Ue(a,[{id:"add",config:{filtered:!0}}])}),[4,L.update(R,{components:encodeURIComponent(JSON.stringify(a))},{id:n})];case 2:return o.sent(),[2]}}))}))},n.fetch(),n}return Je(t,e),t.prototype.fetch=function(){return qe(this,void 0,void 0,(function(){var e,t,n,r;return De(this,(function(a){switch(a.label){case 0:return e=this.props.match,t=(e.params||{}).id,[4,L.query("SELECT components from "+R+" WHERE id="+JSON.stringify(t))];case 1:return n=a.sent(),r=n[0]&&n[0].components,r=JSON.parse(decodeURIComponent(r))||[],this.setState({list:Ue(r,[{id:"add",config:{filtered:!0}}])}),[2]}}))}))},t.prototype.render=function(){var e=this,t=this.state.list,n=(this.props.match.params||{}).id;return o.a.createElement("div",{className:Re.a.wrapper},o.a.createElement(Pe.a,{tag:ze,list:t,setList:this.setList},t.map((function(t){var r=t.title,a=t.config,i=t.id;return"add"===i?o.a.createElement("div",{className:Re.a.col+" "+Re.a.add,id:"add"},o.a.createElement(d.b,{to:"/mugong/bi/add?page="+n},o.a.createElement("div",{className:Re.a.inner},o.a.createElement(Le.a,{className:Re.a.iconAdd,style:{fontSize:"48px",color:"#40a9ff"}})))):o.a.createElement("div",{className:Re.a.col,key:i},o.a.createElement("div",{className:Re.a.inner},o.a.createElement(l.a,{className:Re.a.title},o.a.createElement(u.a,{flex:1},o.a.createElement("div",null,r)),o.a.createElement(u.a,{flex:"24px"},o.a.createElement("a",{onClick:function(){return e.onDelComponent(i)}},o.a.createElement(J.a,{style:{color:"#d20b0b"}})))),o.a.createElement(Ie.a,{config:a})))}))))},t}(o.a.Component),Ge=(n(328),n(106)),We=(n(320),n(185)),Ke=n(131),Fe=n.n(Ke),Ve=n(335),He={string:"abc",number:"num",date:"date"},Qe={sum:"聚合",avg:"平均值",count:"计数",countd:"去重计数"},Xe=function(e){var t=e.field,n=e.dataType,r=e.type,a=e.dropdown,i=e.onChooseAggr;return o.a.createElement("div",{className:Fe.a.field+" "+Fe.a[r]},o.a.createElement(l.a,null,o.a.createElement(u.a,{flex:"1 0",style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},o.a.createElement("span",{style:{marginRight:"4px"}},He[n]||"und"),o.a.createElement("span",null,t)),a&&o.a.createElement(u.a,{flex:"16px"},o.a.createElement(We.a,{trigger:"click",overlay:o.a.createElement(p.a,{onClick:i},Object.keys(Qe).map((function(e){return o.a.createElement(p.a.Item,{key:e},Qe[e])})))},o.a.createElement(Ve.a,null)))))},Ze=n(181),Ye=n.n(Ze),Be={color:"",size:"",label:"",angle:""},$e=function(e){var t=e.type,n=e.title,r=e.children;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:Ye.a.attr},o.a.createElement("div",null,Be[t],n)),r)},et=n(105),tt=n.n(et),nt={row:"X轴",column:"Y轴"},rt=function(e){var t=e.type,n=e.children;return o.a.createElement(l.a,{className:tt.a.axis},o.a.createElement(u.a,{flex:"64px",className:tt.a.type},nt[t]),o.a.createElement(u.a,{flex:"1",className:tt.a.fields},n))},at=n(37),ot=n.n(at),it=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ct=function(){return(ct=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ut=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},lt=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},st=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,c=o.length;i<c;i++,a++)r[a]=o[i];return r},ft=Ge.a.Option,pt={color:"颜色",size:"尺寸",label:"文本",angle:"角度"},dt=[{title:"自动",value:"auto"},{title:"柱图",value:"bar"},{title:"堆叠柱图",value:"barStack"},{title:"并列柱图",value:"barAlign"},{title:"线图",value:"line"},{title:"点图",value:"point"},{title:"区域图",value:"area"},{title:"区域堆叠图",value:"areaStack"},{title:"饼图",value:"pie"},{title:"指环图",value:"ring"},{title:"双轴图",value:"duplex"}],mt=o.a.forwardRef((function(e,t){return o.a.createElement("div",{ref:t,className:"ant-row"},e.children)})),ht=Object(y.b)((function(e){return e}))(function(e){function t(t){var n=e.call(this,t)||this;n.state={title:"标题",tbName:"",tables:[],id:Math.random().toString().slice(2),config:{row:[],column:[],geom:{type:"auto"}},dimensions:[],measures:[],attr:{color:[],size:[],label:[],angle:[]},axis:{row:[],column:[]}},n.onChangeTable=function(e){n.setState({tbName:e,attr:{color:[],size:[],label:[],angle:[]},axis:{row:[],column:[]}}),n.fetchFields(e)},n.fetchData=function(e){var t=e.axis,r=e.attr;return ut(n,void 0,void 0,(function(){var e,n,a,o,i,c,u,l,s,f,p,d,m,h,y,v,b,g,w,_,x;return lt(this,(function(S){switch(S.label){case 0:if(e=this.state,n=e.tbName,a=e.config,o=ct(ct({},this.state.axis),t),i=o.row,c=void 0===i?[]:i,u=o.column,l=void 0===u?[]:u,r=ct(ct({},this.state.attr),r),s=r.color,f=void 0===s?[]:s,p=r.label,d=void 0===p?[]:p,m=r.size,h=void 0===m?[]:m,y=r.angle,v=void 0===y?[]:y,b=c.concat(l,f,d,h,v).reduce((function(e,t){return"dimension"===t.type?e.dimensions.push(t):e.measures.push(t),e}),{dimensions:[],measures:[]}),g=b.dimensions,w=b.measures,!g.length||!w.length)return[2];S.label=1;case 1:return S.trys.push([1,3,,4]),[4,L.query("SELECT "+g.map((function(e){return e.field})).join(",")+","+w.map((function(e){var t=e.aggr||"sum";return"countd"===t?"count (distinct("+e.field+")) as "+e.field:t+"("+e.field+") as "+e.field}))+" FROM "+n+" group by "+(g.map((function(e){return e.field})).join(",")||"1"))];case 2:return _=S.sent(),this.setState({config:ct(ct({},a),{row:1===c.length?c[0]:c,column:1===l.length?l[0]:l,geom:ct(ct({},a.geom),Object.keys(r).reduce((function(e,t){return r[t].length?e[t]=r[t][0]:e[t]=void 0,e}),{})),data:_})}),[3,4];case 3:return x=S.sent(),E.a.error(x.message),[3,4];case 4:return[2]}}))}))},n.setAxis=function(e){var t,r=e.type,a=e.fields,o=n.state.axis,i=ct(ct({},o),((t={})[r]=a,t));n.setState({axis:i}),n.fetchData({axis:i})},n.onSetAggr=function(e,t,r){var a,o=n.state.axis,i=o[e],c=i[t];if(c.aggr!==r){c=ct(ct({},i[t]),{aggr:r});var u=ct(ct({},o),((a={})[e]=i.map((function(e,n){return n===t?c:e})),a));n.setState({axis:u}),n.fetchData({axis:u})}},n.setAttr=function(e){var t,r=e.type,a=e.fields,o=n.state.attr,i=ct(ct({},o),((t={})[r]=a,t));n.setState({attr:i}),n.fetchData({attr:i})},n.onSetAttrAggr=function(e,t){var r,a=n.state.attr;if(a[e][0].aggr!==t){var o=[ct(ct({},a[e][0]),{aggr:t})],i=ct(ct({},a),((r={})[e]=o,r));n.setState({attr:i}),n.fetchData({attr:i})}},n.onChangeType=function(e){var t=n.state.config;n.setState({config:ct(ct({},t),{geom:ct(ct({},t.geom),{type:e})})})},n.doAdd=function(){return ut(n,void 0,void 0,(function(){var e,t,n,r,a,o,i,c,u,l;return lt(this,(function(s){switch(s.label){case 0:e=this.props.history,t=this.state,n=t.id,r=t.title,a=t.config,o=e.location.search.match(/page=(\d+)/),o[0],i=o[1],s.label=1;case 1:return s.trys.push([1,4,,5]),[4,L.query("select components from "+R+" where id="+JSON.stringify(i))];case 2:return c=s.sent(),u=c[0]&&c[0].components||"",u=JSON.parse(decodeURIComponent(u))||[],[4,L.update(R,{components:encodeURIComponent(JSON.stringify(st(u,[{id:n,title:r,config:a}])))},{id:i})];case 3:return s.sent(),e.replace("/mugong/bi/pages/"+i),[3,5];case 4:return l=s.sent(),E.a.error(l.message),[3,5];case 5:return[2]}}))}))};var r=t.dispatch;return n.fetchTables(),r({type:"SET_TOP_NAV",payload:{current:"add"}}),n}return it(t,e),t.prototype.fetchTables=function(){return ut(this,void 0,void 0,(function(){var e,t;return lt(this,(function(n){switch(n.label){case 0:return[4,L.query("SELECT distinct tb_name from my_table_field ")];case 1:return e=n.sent(),t=e[0]&&e[0].tb_name||"",this.setState({tables:e||[],tbName:t}),e.length&&this.fetchFields(t),[2]}}))}))},t.prototype.fetchFields=function(e){return ut(this,void 0,void 0,(function(){var t,n,r,a;return lt(this,(function(o){switch(o.label){case 0:return[4,L.query("SELECT field, type from "+P+" WHERE tb_name='"+e+"'")];case 1:return t=o.sent(),n=t.reduce((function(e,t){return"number"===t.type?e.measures.push({type:"measure",dataType:t.type,field:t.field}):e.dimensions.push({type:"dimension",dataType:t.type,field:t.field}),e}),{dimensions:[],measures:[]}),r=n.dimensions,a=n.measures,this.setState({dimensions:r,measures:a}),[2]}}))}))},t.prototype.render=function(){var e=this,t=this.state,n=t.dimensions,r=void 0===n?[]:n,a=t.measures,i=void 0===a?[]:a,c=t.attr,s=t.axis,f=t.title,p=t.config,d=t.tables,m=void 0===d?[]:d,h=t.tbName;return o.a.createElement(l.a,{align:"top"},o.a.createElement(u.a,{flex:"240px"},o.a.createElement(Ge.a,{style:{width:"88%"},onChange:this.onChangeTable,value:h},m.map((function(e){var t=e.tb_name;return o.a.createElement(ft,{key:t,value:t},t)}))),o.a.createElement("div",{className:ot.a.fieldType},"维度"),o.a.createElement("div",{className:ot.a.fieldWrap},o.a.createElement(Pe.a,{animation:150,list:r,setList:function(t){return e.setState({dimensions:t})},group:{name:"field_dimension_group",pull:"clone",put:!1}},r.map((function(e){return o.a.createElement("div",{style:{margin:"4px"},key:e.field},o.a.createElement(Xe,ct({type:"dimension"},e)))})))),o.a.createElement("div",{className:ot.a.divider}),o.a.createElement("div",{className:ot.a.fieldType},"度量"),o.a.createElement("div",{className:ot.a.fieldWrap},o.a.createElement(Pe.a,{animation:150,list:i,setList:function(t){return e.setState({measures:t})},group:{name:"field_measure_group",pull:"clone",put:!1}},i.map((function(e){return o.a.createElement("div",{style:{margin:"4px"},key:e.field},o.a.createElement(Xe,ct({type:"measure"},e)))}))))),o.a.createElement(u.a,{flex:"180px"},o.a.createElement("div",{className:ot.a.chartType},o.a.createElement(Ge.a,{style:{width:"100%"},onChange:this.onChangeType,value:p.geom.type},dt.map((function(e){return o.a.createElement(ft,{key:e.value,value:e.value},e.title)})))),Object.keys(c).map((function(t){return o.a.createElement($e,{key:t,type:t,title:pt[t]},o.a.createElement("div",{className:ot.a.attrList},o.a.createElement(Pe.a,{list:c[t],setList:function(n){e.setAttr({type:t,fields:n})},onEnd:function(n){var r=n.oldIndex,a=n.newIndex;n.from===n.to&&r===a&&setTimeout((function(){return e.setAttr({type:t,fields:[]})}),0)},group:{name:"field_dimension_group field_measure_group",put:function(){return e.state.attr[t].length<1}}},c[t].map((function(n){return o.a.createElement(Xe,ct({key:n.field,type:n.type},n,{dropdown:"measure"===n.type,onChooseAggr:function(n){var r=n.key;return e.onSetAttrAggr(t,r)}}))})))))}))),o.a.createElement(u.a,{flex:"1",className:ot.a.axisWrap},["row","column"].map((function(t){return o.a.createElement(rt,{type:t,key:t},o.a.createElement("div",{className:ot.a.axisItem},o.a.createElement(Pe.a,{tag:mt,list:s[t],setList:function(n){e.setAxis({type:t,fields:n})},onEnd:function(n){var r=n.oldIndex,a=n.newIndex,o=n.from,i=n.to;console.log("end-f0f-sda"),o===i&&r===a&&setTimeout((function(){var n=e.state.axis,a=st(n[t]);a.splice(r,1),e.setAxis({type:t,fields:a})}),0)},group:{name:"field_dimension_group field_measure_group",put:function(){return e.state.axis[t].length<2}}},s[t].map((function(n,r){return o.a.createElement(u.a,{flex:"118px",key:n.field},o.a.createElement(Xe,ct({type:n.type},n,{dropdown:"measure"===n.type,onChooseAggr:function(n){var a=n.key;return e.onSetAggr(t,r,a)}})))})))))})),o.a.createElement("div",{className:ot.a.inner},o.a.createElement(l.a,null,o.a.createElement(u.a,{flex:1},o.a.createElement(pe.a,{onChange:function(t){return e.setState({title:t.target.value})},style:{border:"none"},value:f})),o.a.createElement(u.a,{width:"120px"},o.a.createElement(F.a,{onClick:this.doAdd},"添加"))),o.a.createElement(Ie.a,{config:p}))))},t}(o.a.Component)),yt=n(82),vt=n.n(yt),bt=n(336),gt=n(337),wt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Et=function(e){function t(t){var n=e.call(this,t)||this;return n.state={title:"标题",visible:!1},n.toggleAdd=function(){n.setState({visible:!n.state.visible})},n}return wt(t,e),t.prototype.render=function(){var e=this.state.visible;return o.a.createElement("div",{className:vt.a.wrapper},o.a.createElement("div",{className:vt.a.uploader},o.a.createElement("div",{style:{marginBottom:"16px",fontSize:"16px"}},o.a.createElement(bt.a,{style:{marginRight:"8px",color:"#d0d021"}}),o.a.createElement("span",null,"如果还没有上传execel，请先上传；然后再去添加页面")),o.a.createElement(le,null)),o.a.createElement("div",null,o.a.createElement("div",{style:{margin:"16px 0",fontSize:"16px"}},o.a.createElement(gt.a,{style:{marginRight:"8px",color:"#13ce4d"}}),o.a.createElement("span",null,"请点击下方新增页面")),o.a.createElement("div",{className:vt.a.add,onClick:this.toggleAdd},o.a.createElement(Le.a,{className:vt.a.iconAdd,style:{fontSize:"48px",color:"#40a9ff"}}))),e&&o.a.createElement(ge,{onClose:this.toggleAdd}))},t}(o.a.Component),_t=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xt=function(){return(xt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},St=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function c(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},Ot=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},kt=/\/(\w+)\/?/,Nt=Object(y.b)((function(e){var t,n,r;return{navLeft:null===(t=e.nav)||void 0===t?void 0:t.left,type:null===(r=null===(n=e.nav)||void 0===n?void 0:n.top)||void 0===r?void 0:r.current}}))(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _t(t,e),t.prototype.componentDidMount=function(){return St(this,void 0,void 0,(function(){var e,t,n,r,a,o,i,c;return Ot(this,(function(u){switch(u.label){case 0:return e=this.props.dispatch,[4,L.query("select left, top from "+A)];case 1:return t=u.sent(),n=t[0]||{},r=n.left,a=void 0===r?"":r,o=n.top,i=void 0===o?"":o,c=location.pathname.match(kt),e({type:"RESET_NAV",payload:{left:re(a)||{},top:xt(xt({},re(i)||{}),{current:c?c[1]:""})}}),[2]}}))}))},t.prototype.render=function(){var e=this.props,t=e.type,n=e.navLeft,r=void 0===n?{}:n,a=r.map&&r.map[t]&&r.map[t].length;return o.a.createElement(d.a,null,o.a.createElement(w,{navs:[{icon:"",title:"Home",link:"/home"}]}),o.a.createElement("div",{className:f.a.content},o.a.createElement(l.a,{className:f.a.row},!!a&&o.a.createElement(u.a,{flex:"254px"},o.a.createElement(K,null)),o.a.createElement(u.a,{flex:"1 1"},o.a.createElement("div",{className:f.a.container},o.a.createElement(me.a,{exact:!0,path:"/mugong/bi",component:_e}),o.a.createElement(me.a,{exact:!0,path:"/mugong/bi/nav",component:Te}),o.a.createElement(me.a,{exact:!0,path:"/mugong/bi/pages",component:Et}),o.a.createElement(me.a,{exact:!0,path:"/mugong/bi/pages/:id",component:Me}),o.a.createElement(me.a,{exact:!0,path:"/mugong/bi/add",component:ht}))))))},t}(o.a.Component)),Ct=Nt,jt=(n(326),n(78)),Tt=function(){return(Tt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Pt=Object(jt.a)((function(e){e.getState,e.dispatch;return function(e){return function(t){return e(t)}}}))(jt.c)((function(e,t){var n=t.type,r=t.payload;switch(n){case"SET_TOP_NAV":return Tt(Tt({},e),{nav:Tt(Tt({},e.nav),{top:Tt(Tt({},e.nav.top),{current:r.current})})});case"RESET_NAV":return Tt(Tt({},e),{nav:r})}return Tt({},e)}),{nav:{}});(function(){c.a.render(o.a.createElement(y.a,{store:Pt},o.a.createElement(Ct,null)),document.getElementById("app"))})()},37:function(e,t,n){e.exports={fieldWrap:"_45rtJQl1Okdr1FLQogz_z",fieldType:"rsv7-lKRWkOWyRGQXnZZS",attrList:"_1O7ToV7y1SUECKOTRB6Tv9",axisWrap:"_1g2lvIXWOz-EiCDob9kYfR",axisItem:"_34SeVMeQD7TFXnSgRKuxZZ"}},4:function(e,t,n){e.exports=n(108)(4)},42:function(e,t,n){e.exports={row:"_2K1H83vdhSf6XU7C_k5gL2",col:"wUwHQu0LKGilRwBhTJ0Bq",add:"_1lXwn-2cXNa5mKkNJEL0-U",inner:"_3NkDJ2pTDUMEhAh0-QomV_",iconAdd:"_2KOwq2uRW7_DrldsPdVGpy",title:"_3HOb0sKgnWOPUEX_c2M-IR"}},82:function(e,t,n){e.exports={uploader:"_3SmJhdAejQq3SA-ap_GofT",add:"_3mdbQ6YahfLdmH77qb605c",inner:"ZJGZRIsAn6mV0DgIiUyld",iconAdd:"_3--hCu0hACg7OFZZnPkFRS"}}});